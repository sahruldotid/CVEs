# CVE-2023-31039

### Vulnerability Explanation
BRPC is an Industrial-grade RPC framework using C++ Language, which is often used in high performance system such as Search, Storage, Machine learning, Advertisement, Recommendation etc. In server.cpp there are function call to wordexp(), it used for expanding path from user input. Due to lack of security mechanism, this function can be used for running system command.

### Vulnerability Type
Arbitrary Code Execution


### Vendor of Product
[Apache bRPC](https://brpc.apache.org/)

### Affected Version
- Apache bRPC < 1.5.0

### Steps to Reproduce
1. Clone this repository
2. Run docker-compose up
3. Run docker compose run --rm brpc
4. Inside the container, run ./build/poc
5. Now check the /tmp/pwned_by_ru1es file


### Disclosure Timeline:
- 2023-04-20: Vulnerability discovered.
- 2023-04-24: Maintainer acknowledge the report.
- 2023-04-27: ASF Security Team validated this vulnerability.
- XXXX-XX-XX: Maintaner fixed the vulnerability.
- XXXX-XX-XX: Assigned CVE but not under my name or vulnerability report platform.
- 2023-05-06: Saw vulnerability has been fixed and i contact the Admin why there's no updates.
- 2023-05-22: Admin replied and said that i need to wait.
- 2023-06-12: Recontact the Admin and ask for updates through DM.
- 2023-06-26: Vulnerability published.


### Discoverer
Syahrul Akbar Rohmani (@sahruldotid / #ru1es)

### Reference
- https://huntr.dev/bounties/c4c8b69e-daf7-4e6b-982b-732936a7d8a4/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31039